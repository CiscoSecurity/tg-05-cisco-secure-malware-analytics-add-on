import { Fragment, useState } from 'react'
import { Body, Cell, Row } from '@table-library/react-table-library'
import cx from 'classnames'
import PropTypes from 'prop-types'

import { Down, Right } from '../../components/Icons/Icons'
import ExpandedView from './ExpandedView'

import styles from './Inputs.module.scss'

const TableBody = ({ tableList }) => {
  const [expandedId, setExpandedId] = useState('')

  return (
    <Body>
      {tableList.map((item) => (
        <Fragment key={item.id}>
          <Row item={item} className="table__row">
            <Cell
              className={cx(styles.expandedCell, 'table__cell')}
              onClick={() => {
                setExpandedId(prevState => item.id === prevState ? '' : item.id)
              }}
            >
              {expandedId === item.id ? <Down /> : <Right/>}
              {item.name}
            </Cell>
            <Cell className="table__cell">{item.content.interval}</Cell>
            <Cell className="table__cell">{item.content.index}</Cell>
            <Cell className="table__cell">
              <label className={cx(styles.switch, 'switch')}>
                <input
                  className="switch__input"
                  type="checkbox"
                  checked={!item.content.disabled}
                />
                <span className="switch__box"></span>
                <span className="switch__label">
                  {item.content.disabled ? 'Disabled' : 'Enabled'}
                </span>
              </label>
            </Cell>
            <Cell className="table__cell">Actions</Cell>
          </Row>
          {expandedId === item.id && <ExpandedView item={item} />}
        </Fragment>
      ))}
    </Body>
  )
}

TableBody.propTypes = {
  tableList: PropTypes.array
}

export default TableBody
