[![Gitter chat](https://img.shields.io/badge/gitter-join%20chat-brightgreen.svg)](https://gitter.im/CiscoSecurity/Lobby "Gitter chat")

### Cisco Secure Malware Analytics Add-On:

The Cisco Secure Malware Analytics Add-On for Splunk leverages the Secure Malware Analytics API to enrich events within Splunk. This occurs by pulling the user's organizational submission data into Splunk making it searchable via timestamps, threat score, user associated with sample submission, and many other options.

### Installation guides:

1. Installation from Store:

    -  Login to your Splunk instance.
  
    -  On the top left of the homescreen click on the "Manage" button

        <img width="1030" alt="Screenshot 2024-01-29 at 15 46 40" src="https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/96125596-8a55-44d8-815d-3af1cd268545">
    
    -  On the top right click the "Browse more apps" button

        ![Screenshot 2024-01-29 at 15 53 57](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/7eae0bab-f57f-41e9-92d0-bf8eb802e88c)

    -  Search for "Cisco Secure Malware Analytics Add-on"

        ![Screenshot 2024-01-29 at 15 58 02](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/6122d5a2-0283-419b-ad0f-65d85bca656c)

    -  Click the "Install" button on the Add-on card.

    -  Add-on should appear in the Apps bar on homescreen of your Splunk instance.

        ![Screenshot 2024-01-29 at 16 00 51](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/0bedd3ed-28eb-41a9-96d5-11cd5e405cc9)

2. Installation from the file:

    -  Download Cisco Secure Malware Analytics Add-On for Splunk from Splunkbase here:
        <https://splunkbase.splunk.com/app/4251/>

    -  Login to your Splunk instance

    -  On the top left of the homescreen click on the "App Settings" button

        <img width="1030" alt="Screenshot 2024-01-29 at 15 46 40" src="https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/c2a2f0f9-f85c-4063-9a4e-6edaa907b838">

    -  On the "Manage" page click the "Install app from file" button on
    the top right

        ![Screenshot 2024-01-29 at 16 03 55](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/fabfc382-7419-4b3f-a3bb-ed04a04afdee)

    -  On the Upload app page click the "Choose File" button and select the
    file from the pop-up
    
    -  Click the "Upload" button

    -  Add-on should appear in the Apps bar on homescreen of your Splunk instance.

        ![Screenshot 2024-01-29 at 16 00 51](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/0bedd3ed-28eb-41a9-96d5-11cd5e405cc9)

### Configuration Guide

1.  In the Apps bar on the homescreen click on the "Cisco Secure Malware Analytics" icon

    ![Screenshot 2024-01-29 at 16 00 51](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/ac1de959-c6d2-4b8a-bb1b-dd381fe103d4)


2.  Go to the Configuration tab

3.  Click the "Add Account" button

    ![Screenshot 2024-01-29 at 16 13 52](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/aab7c627-b331-40ab-a21f-9a6bdd91f087)


4.  Fill out the form to create an Account that will be used for Input Creation:

       - *Account name* - Enter a title for the account.
       - *Host* - Enter the host for your Cisco Secure Malware Analytics instance.
       - *API Key* - Enter API Key from your Cisco Secure Malware Analytics instance.
         
5.  If needed add Proxy settings.

6.  Go to the Inputs tab

7.  Click the "Create New Input" button

    ![Screenshot 2024-01-29 at 16 35 53](https://github.com/CiscoSecurity/tg-05-cisco-secure-malware-analytics-add-on/assets/78480384/84f738a8-9f61-4126-bb5f-793060d97164)


8.  Fill out the form to create an Input:

   - *Name* - Enter a name for the input.
   - *Interval* - Enter the time interval in seconds between API queries. Recommended to leave the default value.
   - *Index* - Choose an index in which events will be created.
   - *After* - Enter the period of a lookback for a query. Recommended to leave the default value.
   - *Global Account* - Choose an account you would like to use for the new input.

9.  Go to Search tab to search for events.

**Note**: To search for events you can add `sourcetype="cisco:sma:data"` or `source="cisco_secure_malware_analytics_input://<name_of_the_input>"` expressions to the search.

